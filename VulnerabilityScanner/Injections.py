import requests
from bs4 import BeautifulSoup as bs
from abc import ABC, abstractmethod


class Injections:
    @abstractmethod
    def get_all_forms_html(quiet, url):
        if not quiet:
            print("[-] Getting html forms")
        req = requests.get(url).content
        soup = bs(req, 'html.parser')
        return soup.find_all('form')

    @abstractmethod
    def get_form_details(form):
        details_form = {}               # Dictionary for action, method and input
        action = form.attrs.get('action').lower()
        method = form.attrs.get('method', 'get').lower()
        # Get type, text and name of input
        form_inputs = []
        for tag in form.find_all("input"):
            input_type = tag.attrs.get("type", "text")
            input_name = tag.attrs.get("name")
            input_value = tag.attrs.get("value", "")
            form_inputs.append({"type": input_type, "name": input_name, "value": input_value})
        # Put everything to resulting dictionary
        details_form["action"] = action
        details_form["method"] = method
        details_form["inputs"] = form_inputs

        return details_form


