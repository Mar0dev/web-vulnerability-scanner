
# Web Vulnerability Scanner

Yet another approach to find common vulnerabilities :star2:


## Features

- Find XSS and SQLi vulnerabilities in forms
- Search for LFI vulnerabilities
- Crawl URL's from provided site
- Spoof User-Agent header in each request to reduce the chances of detection by WAF :bricks:
- Check configuration of security headers
- Quiet mode & report generation
- Scan open ports (with nmap)


## Requirements

- Python 3.11.7 or later
- Packages from requirements.txt
- nmap (optional)


## Installation

Install this scanner:

```bash
  git clone https://github.com/Mar0dev/web-vulnerability-scanner.git
  cd web-vulnerability-scanner
  pip install -r requirements.txt
```
    
## Usage

```bash
python3 ./scanner.py -h
```
Will display help for a tool:
```
usage: scanner.py [-h] [-c DEPTH] [-q] -u URL [-xp XSSPAYLOAD] [-lu LFI_URL] [-nh]

options:
  -h, --help            show this help message and exit
  -c DEPTH, --crawler DEPTH
                        Crawl to provided depth
  -q, --quiet           quiet mode - no console output generated
  -u URL, --url URL     Provide URL for web application, example: https://www.example.com
  -xp XSSPAYLOAD, --xsspayload XSSPAYLOAD
                        Path to XSS payload folder
  -lu LFI_URL, --lfiurl LFI_URL
                        Provide url with parameters to perform advanced LFI scan, example:https://www.example.com/page.php?file=
  -nh, --nohttps        Dont check for https header
```
Deeper explanation:

`-u` parameter expects URL address of host that will be scanned

`-nh` parameter can be used if we don't want to check HSTS header

`-lu` is specially crafted URL of .php page that ends with parameter
for e.g. `https://www.example.com/page.php?file=`.
This URL will be scanned separately.

`-c` will enable crawler. Argument should be an Intiger value which will define depth of the scan. If you choose 3 and provide URL, it will get all the URLs on this page. Then it will enter every found URL in the search for new URLs. And then it will repeat action again. URLs are unique and related to host, to not get out of the target scope.

#### Examples

Scan `http://testphp.vulnweb.com/guestbook.php` with quiet mode and without checking HSTS header:

`python3 ./scanner.py -u http://testphp.vulnweb.com/guestbook.php -q -nh`

Scan `http://testphp.vulnweb.com` with extended list of XSS payloads with crawler depth set to 3:

`python3 ./scanner.py -u http://testphp.vulnweb.com -c 3 -xp ./payloads/xss_payloads_long.txt`

:page_facing_up: each scan will generate a report with the date of scan.


#### Report example

Report example of scan for site `http://testphp.vulnweb.com/guestbook.php` is present in repo as `audit_20240210-1607`. It contains two XSS vulnerabilities found on site.

#### Payloads info:
If not provided by `-xp` argument a tool will scan for XSS using payloads from `/payloads/xss_payloads_short.txt` file

SQLi is error based

LFI detection works on PHP sites
## License

[MIT](https://choosealicense.com/licenses/mit/)

